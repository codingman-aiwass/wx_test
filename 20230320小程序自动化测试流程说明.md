#### 程序执行流程
1. 启动微信，点击发现，点击小程序，进入 小程序-最近使用 界面(但是有时候自动化进入的方法会报错崩溃，考虑后续直接手动进入这个页面)，方便在自动化测试时不小心退出小程序的时候能够回到刚刚退出的小程序，同时在该界面下也能够通过wx.navigateToMiniProgram()跳转进入指定appId的小程序
2. 检查微信是否只有NATIVE_APP模式，如果只有这一种模式，kill微信并执行第一步.因为在这个状态下，无法使用driver.execute_script() 执行js注入，没办法回到上一个目录
3. 通过appID启动指定小程序
4. 进入小程序以后，等待几秒钟，确保首页广告(5s跳过那种)能被跳过
5. 检查是否有隐私政策界面，有则同意（有的小程序的隐私政策弹窗不在xml中，在webview里，比如掌上公交）
6. 检查是否有位置权限请求界面，有则同意
7. 检查是否有广告弹窗，有则关闭(通过检查本html页面中的组件是否有的class属性的值中含有close，有就点击)
8. 如果是在未登录状态下进入小程序的首页，执行点击时有可能会被强制跳转到登录账号界面(比如菜鸟)，**考虑先在首页或者我的页面寻找登录按钮并点击(TODO)，先完成登录再进行遍历，如果常规的方法无法完成某些琐碎的细节，看这些琐碎的细节出现的频率高不高。不高的话就不做了**。有的小程序(比如公交、地图类、点餐、外卖小程序)也有可能会在点击掉广告弹窗之后就进入**选择城市页面**，需要直接点击一个通过，不需要遍历所有城市。(TODO)
9. 登录小程序以后，可能会出现广告弹窗，采用和第7步一样的方式处理
10. 获取小程序NATIVE_APP模式下的xml，获取该页面所有组件的坐标，优先点击进入 我的 相关的页面。
11. 在点击过程中，可能会不小心进入其他小程序或者不小心退出本次测试的小程序，此时需要判断并回退到原来的小程序(TODO，之前单独实现过，还需要封装整合和测试)。此时也有可能触发 请求获取消息发送通知 的弹窗，需要处理(TODO)
12. 执行点击操作后，检查是否进入新页面，每进入一个新页面就将该新页面URL以及请求参数就添加到待遍历页面队列中。并判断该页面是否有弹窗/权限请求，有的话处理掉再然后回退到原页面.(TODO,但是如果这么做，等待弹窗出现可能需要花费1-2s，有点耗时)
13. 回到上一级页面，判断是否出现弹窗/权限请求，有的话处理掉再然后回退到原页面.(TODO,但是如果这么做，等待弹窗出现可能需要花费1-2s，有点耗时)
14. 点击完点击完一层以后，从刚才的新页面队列中取出新的页面URL以及请求参数，跳转到该页面，并重复执行10-13步(TODO)

TODO 表示还没有实现

#### 待解决的问题
1. 有的小程序需要在两个地方勾选阅读并同意隐私政策，第一次是打开的时候首页，第二次是进入手机验证码登录界面的时候。但是在第二次，可能会出现单选框/多选框的底层实现不是checkbox 或者 radio，无法在页面中定位到，就无法点击。看这个情景出现的多不多，不多的话就不弄了。应该不多。
2. 点击前后都判断是否出现广告弹窗/权限弹窗可能会较为耗时
3. 到店点餐类、公交类、外卖小程序会在进入首页之前进入选择城市页面，需要单独处理
4. 加入一个超时机制，如果长时间页面内容没有变化过，采取各种措施处理，包括 返回上一级页面，退出重开等操作
5. 加入隐私导向机制，优先去点击可能和用户隐私相关的东西
6. 第5点如何实现。。目前的技术方案是广度优先，需要在遍历完一个页面以后再遍历二级页面。
7. 如果进入了隐私政策页面，尝试提取隐私政策URL。应该可以用frida实现，到时候看看
8. 如果一个页面卡太久，需要采取一些措施处理一下。问问另一位师兄
9. 部署抓包环境
